{
  "id": "8fRjPcH3dc54VPPX",
  "name": "hartran-linkedin-article",
  "active": false,
  "nodes": [
    {
      "parameters": {},
      "id": "trigger-manual",
      "name": "üöÄ D√©clencheur Manuel",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "507bd4507b644b78b44d4ceeb809f1e0",
          "mode": "id"
        },
        "filterType": "manual",
        "conditions": {
          "conditions": [
            {
              "key": "Statut",
              "condition": "equals",
              "value": "Non trait√©"
            }
          ]
        },
        "sort": {
          "sortValue": [
            {
              "key": "Priorit√©",
              "type": "select",
              "direction": "descending"
            }
          ]
        },
        "limit": 1,
        "options": {}
      },
      "id": "notion-get-ideas",
      "name": "üì• R√©cup√©rer Id√©e Non Trait√©e",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [450, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.perplexity.ai/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{$credentials.apiKey}}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"sonar\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"Tu es un expert en recherche d'informations sur les sujets de web analyse et data analyse. Tu dois effectuer une recherche approfondie et fournir des informations actuelles, des statistiques, des tendances et des exemples concrets.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Effectue une recherche approfondie sur le sujet suivant pour un article LinkedIn professionnel:\\n\\nTitre: {{ $json.properties['Titre'].title[0].plain_text }}\\n\\nContexte et sources: {{ $json.properties['Contexte et sources'].rich_text[0].plain_text }}\\n\\nRecherche les derni√®res actualit√©s, statistiques, √©tudes de cas, et innovations sur ce sujet. Fournis des donn√©es concr√®tes et v√©rifiables.\"\n    }\n  ],\n  \"search\": true\n}",
        "options": {}
      },
      "id": "perplexity-research",
      "name": "üîç Enrichir avec Perplexity",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [650, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{$credentials.apiKey}}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 2000,\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"Tu es un expert en r√©daction d'articles LinkedIn professionnels sur des sujets de web analyse et data analyse. Tu r√©diges des articles engageants de 800-1200 mots avec une structure claire et des insights pratiques.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"R√©dige un article LinkedIn professionnel bas√© sur les informations suivantes:\\n\\nSujet: {{ $node['notion-get-ideas'].json.properties['Titre'].title[0].plain_text }}\\n\\nNotes personnelles: {{ $node['notion-get-ideas'].json.properties['Notes personnelles'].rich_text[0]?.plain_text || 'Aucune note sp√©cifique' }}\\n\\nQuestion √† adresser: {{ $node['notion-get-ideas'].json.properties['Question √† adresser'].rich_text[0]?.plain_text || 'Aucune question sp√©cifique' }}\\n\\nRecherche Perplexity:\\n{{ $json.body.choices[0].message.content }}\\n\\nConsignes:\\n- Structure avec une accroche forte\\n- D√©veloppement avec exemples concrets\\n- Insights pratiques et actionnables\\n- Conclusion avec appel √† l'action\\n- Ton professionnel mais accessible\\n- Int√®gre l'angle d√©fini dans les notes personnelles et questions si fourni\"\n    }\n  ]\n}",
        "options": {}
      },
      "id": "claude-write",
      "name": "‚úçÔ∏è R√©diger avec Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [850, 300]
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4",
          "mode": "list"
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Tu es un expert en marketing LinkedIn. G√©n√®re exactement 10 hashtags pertinents pour l'article fourni. M√©lange hashtags populaires et sp√©cialis√©s dans le domaine de l'analytics et du data."
            },
            {
              "role": "user", 
              "content": "=G√©n√®re 10 hashtags pour cet article LinkedIn:\n\n{{ $json.content[0].text }}\n\nRetourne uniquement les hashtags s√©par√©s par des espaces, sans num√©rotation ni autre texte."
            }
          ]
        },
        "options": {}
      },
      "id": "openai-hashtags",
      "name": "üè∑Ô∏è G√©n√©rer Hashtags",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [1050, 300]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "create",
        "databaseId": {
          "__rl": true,
          "value": "9b915f4f6bae479f9326ff2cfdabadd3",
          "mode": "id"
        },
        "title": "={{ $node['notion-get-ideas'].json.properties['Titre'].title[0].plain_text }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Titre",
              "title": "={{ $node['notion-get-ideas'].json.properties['Titre'].title[0].plain_text }}"
            },
            {
              "key": "Statut",
              "select": "Publi√©"
            },
            {
              "key": "Date de g√©n√©ration",
              "date": "={{ $now }}"
            },
            {
              "key": "Id√©e source",
              "relationValue": ["{{ $node['notion-get-ideas'].json.id }}"]
            },
            {
              "key": "Hashtags",
              "textValue": "={{ $node['openai-hashtags'].json.choices[0].message.content }}"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "type": "heading_1",
              "textContent": "={{ $node['notion-get-ideas'].json.properties['Titre'].title[0].plain_text }}"
            },
            {
              "type": "paragraph",
              "textContent": "={{ $node['claude-write'].json.content[0].text }}"
            },
            {
              "type": "divider"
            },
            {
              "type": "heading_3",
              "textContent": "Hashtags"
            },
            {
              "type": "paragraph",
              "textContent": "={{ $node['openai-hashtags'].json.choices[0].message.content }}"
            }
          ]
        },
        "options": {}
      },
      "id": "notion-save-article",
      "name": "üíæ Sauvegarder Article",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [1250, 300]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $node['notion-get-ideas'].json.id }}",
          "mode": "id"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Statut",
              "select": "Trait√©"
            },
            {
              "key": "Date de traitement",
              "date": "={{ $now }}"
            }
          ]
        },
        "options": {}
      },
      "id": "notion-update-idea",
      "name": "‚úÖ Marquer Id√©e Trait√©e",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [1450, 300]
    }
  ],
  "connections": {
    "üöÄ D√©clencheur Manuel": {
      "main": [
        [
          {
            "node": "üì• R√©cup√©rer Id√©e Non Trait√©e",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì• R√©cup√©rer Id√©e Non Trait√©e": {
      "main": [
        [
          {
            "node": "üîç Enrichir avec Perplexity",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîç Enrichir avec Perplexity": {
      "main": [
        [
          {
            "node": "‚úçÔ∏è R√©diger avec Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚úçÔ∏è R√©diger avec Claude": {
      "main": [
        [
          {
            "node": "üè∑Ô∏è G√©n√©rer Hashtags",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üè∑Ô∏è G√©n√©rer Hashtags": {
      "main": [
        [
          {
            "node": "üíæ Sauvegarder Article",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üíæ Sauvegarder Article": {
      "main": [
        [
          {
            "node": "‚úÖ Marquer Id√©e Trait√©e",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": null,
  "triggerCount": 0,
  "tags": []
}