{
  "name": "hartran-linkedin-article-corrige",
  "nodes": [
    {
      "parameters": {},
      "id": "trigger-manual",
      "name": "ğŸš€ DÃ©clencheur Manuel",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [256, 304]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "507bd4507b644b78b44d4ceeb809f1e0",
          "mode": "id"
        },
        "limit": 1,
        "filterType": "manual",
        "options": {}
      },
      "id": "notion-get-ideas",
      "name": "ğŸ“¥ RÃ©cupÃ©rer IdÃ©e Non TraitÃ©e",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [480, 304],
      "credentials": {
        "notionApi": {
          "id": "aH0S5x4M973O80uj",
          "name": "Notion LinkedIn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// PrÃ©parer et dÃ©boguer les donnÃ©es de l'idÃ©e Notion\nconst notionItem = $json;\n\nconsole.log('=== DONNÃ‰ES REÃ‡UES DE NOTION ===');\nconsole.log(JSON.stringify(notionItem, null, 2));\n\n// Extraire les donnÃ©es importantes\nlet titre = 'Article sur la web analyse et data';\nlet sources = '';\nlet notes = '';\nlet angle = '';\nlet questions = '';\nlet pourquoi = '';\nlet stats = '';\nlet citations = '';\n\n// Essayer diffÃ©rentes faÃ§ons d'accÃ©der aux propriÃ©tÃ©s\nif (notionItem?.properties) {\n  // Titre\n  titre = notionItem.properties?.title?.[0]?.plain_text || \n          notionItem.properties?.['Titre/IdÃ©e principale']?.title?.[0]?.plain_text ||\n          notionItem.properties?.Name?.title?.[0]?.plain_text ||\n          'Article sur la web analyse et data';\n  \n  // Sources\n  sources = notionItem.properties?.['Sources/URLs']?.rich_text?.[0]?.plain_text || '';\n  \n  // Notes personnelles\n  notes = notionItem.properties?.['Notes personnelles']?.rich_text?.[0]?.plain_text || '';\n  \n  // Angle personnel\n  angle = notionItem.properties?.['Angle personnel']?.rich_text?.[0]?.plain_text || '';\n  \n  // Questions\n  questions = notionItem.properties?.['Questions Ã  adresser']?.rich_text?.[0]?.plain_text || '';\n  \n  // Pourquoi maintenant\n  pourquoi = notionItem.properties?.['Pourquoi maintenant?']?.rich_text?.[0]?.plain_text || '';\n  \n  // Statistiques\n  stats = notionItem.properties?.['Data/Statistiques']?.rich_text?.[0]?.plain_text || '';\n  \n  // Citations\n  citations = notionItem.properties?.['Citations clÃ©s']?.rich_text?.[0]?.plain_text || '';\n}\n\nconsole.log('=== DONNÃ‰ES EXTRAITES ===');\nconsole.log('Titre:', titre);\nconsole.log('Sources:', sources);\nconsole.log('Notes:', notes);\nconsole.log('Angle:', angle);\nconsole.log('Questions:', questions);\n\n// Retourner toutes les donnÃ©es + les donnÃ©es formatÃ©es\nreturn {\n  ...notionItem,\n  extracted: {\n    titre,\n    sources,\n    notes,\n    angle,\n    questions,\n    pourquoi,\n    stats,\n    citations\n  }\n};"
      },
      "id": "prepare-notion-data",
      "name": "ğŸ” PrÃ©parer donnÃ©es idÃ©e",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [600, 304]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Effectue une recherche approfondie sur le sujet suivant pour un article LinkedIn professionnel:\n\nTitre: {{ $json.extracted?.titre || 'Article sur la web analyse et data' }}\n\nContexte et sources: {{ $json.extracted?.sources || 'Non fourni' }}\n\nNotes personnelles: {{ $json.extracted?.notes || 'Expert en web analyse et data analyse' }}\n\nAngle personnel: {{ $json.extracted?.angle || '' }}\n\nQuestions Ã  adresser: {{ $json.extracted?.questions || '' }}\n\nPourquoi maintenant: {{ $json.extracted?.pourquoi || '' }}\n\nData/Statistiques: {{ $json.extracted?.stats || '' }}\n\nCitations clÃ©s: {{ $json.extracted?.citations || '' }}\n\nIMPORTANT: Le sujet est RÃ‰EL et concret. Effectue une recherche approfondie sur ce sujet prÃ©cis. Ne dis pas qu'il manque des informations.\n\nRecherche les derniÃ¨res actualitÃ©s, statistiques, Ã©tudes de cas, et innovations sur ce sujet. Fournis des donnÃ©es concrÃ¨tes et vÃ©rifiables.",
        "options": {
          "systemMessage": "Tu es un expert en recherche d'informations sur les sujets de web analyse et data analyse. Tu dois effectuer une recherche approfondie et fournir des informations actuelles, des statistiques, des tendances et des exemples concrets. Utilise tes capacitÃ©s de recherche web pour trouver les informations les plus rÃ©centes et pertinentes."
        }
      },
      "id": "perplexity-agent",
      "name": "ğŸ” Agent Recherche Perplexity",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [704, 400]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=RÃ©dige un article LinkedIn professionnel de 800-1200 mots basÃ© sur les informations suivantes:\n\nSujet principal: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.titre || 'Article sur la web analyse et data' }}\n\nNotes personnelles: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.notes || '' }}\n\nAngle personnel: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.angle || '' }}\n\nQuestions Ã  adresser: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.questions || '' }}\n\nPourquoi maintenant: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.pourquoi || '' }}\n\nData/Statistiques Ã  intÃ©grer: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.stats || '' }}\n\nCitations clÃ©s: {{ $('ğŸ” PrÃ©parer donnÃ©es idÃ©e').first().json.extracted?.citations || '' }}\n\nRecherche effectuÃ©e:\n{{ $json.output }}\n\nIMPORTANT: Tu DOIS rÃ©diger un article complet sur le sujet donnÃ©. Ne dis JAMAIS qu'il manque des informations. Utilise toutes les donnÃ©es fournies pour crÃ©er un article pertinent et engageant.\n\nConsignes:\n- Article de 800-1200 mots COMPLET (pas de message d'erreur)\n- Structure avec une accroche forte sur le sujet donnÃ©\n- DÃ©veloppement avec exemples concrets tirÃ©s de la recherche\n- Insights pratiques et actionnables\n- Conclusion avec appel Ã  l'action\n- Ton professionnel mais accessible\n- IntÃ¨gre TOUS les Ã©lÃ©ments fournis (angle personnel, questions, statistiques, citations)\n- Le sujet est TOUJOURS liÃ© Ã  la web analyse, data analyse ou l'IA\n\nNE JAMAIS rÃ©pondre qu'il manque des informations. TOUJOURS crÃ©er un article complet.",
        "options": {
          "systemMessage": "Tu es un expert en rÃ©daction d'articles LinkedIn professionnels sur des sujets de web analyse et data analyse. Tu rÃ©diges des articles engageants avec une structure claire et des insights pratiques. Tu adaptes ton angle Ã©ditorial en fonction des notes personnelles et questions fournies."
        }
      },
      "id": "claude-agent",
      "name": "âœï¸ Agent RÃ©daction Claude",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [1056, 400]
    },
    {
      "parameters": {
        "model": "claude-3-opus-20240229",
        "options": {}
      },
      "id": "claude-model",
      "name": "Claude Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.2,
      "position": [992, 608],
      "credentials": {
        "anthropicApi": {
          "id": "Ylmsz8Ymq9adIJs0",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=GÃ©nÃ¨re exactement 10 hashtags pertinents pour cet article LinkedIn:\n\n{{ $json.output }}\n\nRetourne uniquement les hashtags sÃ©parÃ©s par des espaces, sans numÃ©rotation ni autre texte. MÃ©lange hashtags populaires et spÃ©cialisÃ©s dans le domaine de l'analytics et du data.",
        "options": {
          "systemMessage": "Tu es un expert en marketing LinkedIn. Tu gÃ©nÃ¨res des hashtags optimisÃ©s pour maximiser la visibilitÃ© des articles."
        }
      },
      "id": "openai-agent",
      "name": "ğŸ·ï¸ Agent Hashtags GPT",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [1408, 400]
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "chatgpt-4o-latest"
        },
        "options": {}
      },
      "id": "openai-model",
      "name": "OpenAI Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [1480, 624],
      "credentials": {
        "openAiApi": {
          "id": "W3z11iU8VRrweFEt",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Tu es un expert en copywriting LinkedIn. Transforme cet article en un post LinkedIn percutant de 300-500 mots.\n\nArticle complet :\n{{ $('âœï¸ Agent RÃ©daction Claude').first().json.output }}\n\nHashtags Ã  intÃ©grer :\n{{ $('ğŸ·ï¸ Agent Hashtags GPT').first().json.output }}\n\nConsignes :\n- Accroche forte dÃ¨s la premiÃ¨re ligne (sans le titre de l'article)\n- Structure aÃ©rÃ©e avec sauts de ligne\n- Points clÃ©s avec emojis appropriÃ©s\n- Statistiques percutantes mises en avant\n- Appel Ã  l'action clair et engageant\n- Style direct et conversationnel\n- Ã‰viter le jargon technique complexe\n- CrÃ©er de l'Ã©motion et de l'engagement\n\nFormat attendu :\n[Emoji percutant] [Accroche qui donne envie de lire la suite]\n\n[Contexte en 2-3 lignes maximum]\n\n[3-5 points clÃ©s avec emojis]\n\n[Statistique ou exemple concret]\n\n[Question ou appel Ã  l'action]\n\n[Ligne vide]\n\n[Tous les hashtags]",
        "options": {
          "systemMessage": "Tu es un expert en copywriting et marketing LinkedIn. Tu transformes des articles longs en posts LinkedIn engageants et viraux. Tu maÃ®trises l'art de l'accroche, du storytelling court et de l'appel Ã  l'action. Ton style est professionnel mais accessible, avec une touche d'Ã©motion pour crÃ©er de l'engagement."
        }
      },
      "id": "linkedin-synthesis",
      "name": "ğŸ“± SynthÃ¨se LinkedIn Claude",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [1580, 400]
    },
    {
      "parameters": {
        "model": "anthropic/claude-3.5-sonnet",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [1580, 576],
      "id": "linkedin-claude-model",
      "name": "Claude LinkedIn Model",
      "credentials": {
        "openRouterApi": {
          "id": "xLdMbYh4lyLsgJJA",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// PrÃ©paration des donnÃ©es pour la sauvegarde Notion - VERSION 7\n\n// RÃ©cupÃ©rer les donnÃ©es du nÅ“ud Notion\nconst notionItem = $('ğŸ“¥ RÃ©cupÃ©rer IdÃ©e Non TraitÃ©e').first().json;\n\n// RÃ©cupÃ©rer l'ID de l'idÃ©e\nconst ideaId = notionItem?.id || \"\";\n\n// RÃ©cupÃ©rer le contenu COMPLET de l'article depuis Claude\nlet contenuArticleComplet = \"\";\ntry {\n  contenuArticleComplet = $('âœï¸ Agent RÃ©daction Claude').first().json.output || \"\";\n} catch (e) {\n  console.log(\"Erreur lors de la rÃ©cupÃ©ration du contenu Claude:\", e.message);\n}\n\n// Extraire le titre depuis le contenu - chercher aprÃ¨s \"Titre:\"\nlet titreFinal = \"Sans titre\";\nconst matchTitre = contenuArticleComplet.match(/Titre\\s*:\\s*(.+)/i);\nif (matchTitre && matchTitre[1]) {\n  titreFinal = matchTitre[1].trim();\n  console.log(\"Titre extrait avec regex:\", titreFinal);\n} else {\n  // Si pas trouvÃ©, prendre la premiÃ¨re ligne non vide\n  const lignes = contenuArticleComplet.split('\\n').filter(l => l.trim());\n  if (lignes.length > 0 && lignes[0].length > 10 && lignes[0].length < 200) {\n    titreFinal = lignes[0].trim();\n    console.log(\"Titre pris depuis premiÃ¨re ligne:\", titreFinal);\n  }\n}\n\n// RÃ©cupÃ©rer les hashtags depuis GPT\nlet hashtags = \"\";\ntry {\n  hashtags = $('ğŸ·ï¸ Agent Hashtags GPT').first().json.output || \"\";\n} catch (e) {\n  console.log(\"Erreur lors de la rÃ©cupÃ©ration des hashtags:\", e.message);\n}\n\n// RÃ©cupÃ©rer le post LinkedIn synthÃ©tisÃ©\nlet postLinkedInSynthetise = \"\";\ntry {\n  postLinkedInSynthetise = $('ğŸ“± SynthÃ¨se LinkedIn Claude').first().json.output || \"\";\n  console.log(\"Post LinkedIn synthÃ©tisÃ© rÃ©cupÃ©rÃ©\");\n} catch (e) {\n  console.log(\"Erreur lors de la rÃ©cupÃ©ration du post LinkedIn:\", e.message);\n  // Fallback\n  const emojis = [\"ğŸš€\", \"ğŸ“Š\", \"ğŸ’¡\", \"ğŸ¯\", \"âœ¨\"];\n  const emoji = emojis[Math.floor(Math.random() * emojis.length)];\n  postLinkedInSynthetise = `${emoji} ${contenuArticleComplet.substring(0, 400)}...\\n\\n${hashtags}`;\n}\n\n// Extraction des statistiques clÃ©s\nconst stats = contenuArticleComplet.match(/\\d+[%â‚¬$]?|\\d+\\s*(millions?|milliards?|%)/gi) || [];\nconst statistiquesCles = stats.join(', ');\n\n// IMPORTANT : Pour la propriÃ©tÃ© \"Contenu article\"\n// On va essayer une approche intelligente\nlet contenuPourPropriete = \"\";\n\n// Si l'article fait moins de 2000 caractÃ¨res, on le met en entier\nif (contenuArticleComplet.length <= 2000) {\n  contenuPourPropriete = contenuArticleComplet;\n  console.log(\"Article complet tient dans la propriÃ©tÃ©\");\n} else {\n  // Sinon, on crÃ©e un rÃ©sumÃ© intelligent\n  // Option 1 : Prendre le dÃ©but jusqu'Ã  une fin de phrase\n  let cutIndex = 1950; // Un peu moins que 2000 pour la marge\n  \n  // Chercher la fin de phrase la plus proche avant 1950\n  const finsDePhrases = ['. ', '! ', '? ', '\\n\\n'];\n  for (const fin of finsDePhrases) {\n    const lastIndex = contenuArticleComplet.lastIndexOf(fin, cutIndex);\n    if (lastIndex > 1500) { // Au moins 1500 caractÃ¨res\n      cutIndex = lastIndex + fin.length - 1;\n      break;\n    }\n  }\n  \n  contenuPourPropriete = contenuArticleComplet.substring(0, cutIndex).trim();\n  \n  // Ajouter une indication discrÃ¨te\n  if (!contenuPourPropriete.endsWith('.') && !contenuPourPropriete.endsWith('!') && !contenuPourPropriete.endsWith('?')) {\n    contenuPourPropriete += '...';\n  }\n  \n  console.log(`Article rÃ©sumÃ© intelligemment : ${cutIndex} caractÃ¨res sur ${contenuArticleComplet.length}`);\n}\n\n// Pour le post LinkedIn, mÃªme logique\nlet postLinkedInPourPropriete = postLinkedInSynthetise;\nif (postLinkedInSynthetise.length > 2000) {\n  // Le post synthÃ©tisÃ© ne devrait pas dÃ©passer 500 mots donc ~3000 caractÃ¨res max\n  // Mais au cas oÃ¹, on coupe intelligemment\n  let cutIndex = 1950;\n  const finsDePhrases = ['. ', '! ', '? ', '\\n\\n'];\n  for (const fin of finsDePhrases) {\n    const lastIndex = postLinkedInSynthetise.lastIndexOf(fin, cutIndex);\n    if (lastIndex > 1500) {\n      cutIndex = lastIndex + fin.length - 1;\n      break;\n    }\n  }\n  postLinkedInPourPropriete = postLinkedInSynthetise.substring(0, cutIndex).trim();\n}\n\n// Log pour dÃ©bogage\nconsole.log(\"=== DONNÃ‰ES PRÃ‰PARÃ‰ES V7 ===\");\nconsole.log(\"- Titre final:\", titreFinal);\nconsole.log(\"- Longueur article complet:\", contenuArticleComplet.length);\nconsole.log(\"- Longueur contenu propriÃ©tÃ©:\", contenuPourPropriete.length);\nconsole.log(\"- Longueur post LinkedIn:\", postLinkedInSynthetise.length);\nconsole.log(\"- Article tronquÃ© ?\", contenuArticleComplet.length > 2000 ? \"Oui (limite Notion)\" : \"Non\");\n\n// Retourner toutes les donnÃ©es\nreturn {\n  // DonnÃ©es pour les propriÃ©tÃ©s\n  titre: titreFinal,\n  contenuArticle: contenuPourPropriete,\n  hashtags: hashtags,\n  postLinkedInComplet: postLinkedInPourPropriete,\n  statistiquesCles: statistiquesCles.substring(0, 2000),\n  \n  // DonnÃ©es complÃ¨tes pour le corps de la page\n  contenuArticleComplet: contenuArticleComplet,\n  postLinkedInCompletTotal: postLinkedInSynthetise,\n  \n  // MÃ©tadonnÃ©es\n  ideaId: ideaId,\n  dateGeneration: new Date().toISOString(),\n  longueurArticle: contenuArticleComplet.length,\n  nombreMots: contenuArticleComplet.split(/\\s+/).length,\n  articleTronque: contenuArticleComplet.length > 2000\n};"
      },
      "id": "prepare-data",
      "name": "ğŸ“‹ PrÃ©parer donnÃ©es finales",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1760, 400]
    },
    {
      "parameters": {
        "jsCode": "// PrÃ©paration du JSON pour l'API Notion - VERSION 5\nconst notionPayload = {\n  parent: {\n    database_id: \"9b915f4f6bae479f9326ff2cfdabadd3\"\n  },\n  properties: {\n    \"Titre\": {\n      title: [\n        {\n          text: {\n            content: $json.titre || \"Sans titre\"\n          }\n        }\n      ]\n    },\n    \"Contenu article\": {\n      rich_text: [\n        {\n          text: {\n            // Version rÃ©sumÃ©e pour la propriÃ©tÃ©\n            content: $json.contenuArticle || \"\"\n          }\n        }\n      ]\n    },\n    \"Hashtags\": {\n      rich_text: [\n        {\n          text: {\n            content: $json.hashtags || \"\"\n          }\n        }\n      ]\n    },\n    \"Post LinkedIn complet\": {\n      rich_text: [\n        {\n          text: {\n            // Version rÃ©sumÃ©e avec emoji et hashtags\n            content: $json.postLinkedInComplet || \"\"\n          }\n        }\n      ]\n    },\n    \"Public cible\": {\n      select: {\n        name: \"Professionnels et dÃ©cideurs\"\n      }\n    },\n    \"Statistiques clÃ©s\": {\n      rich_text: [\n        {\n          text: {\n            content: $json.statistiquesCles || \"\"\n          }\n        }\n      ]\n    }\n  },\n  // Ajouter le contenu complet dans le corps de la page\n  children: [\n    {\n      object: \"block\",\n      type: \"heading_1\",\n      heading_1: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: $json.titre || \"Article LinkedIn\"\n            }\n          }\n        ]\n      }\n    },\n    {\n      object: \"block\",\n      type: \"divider\",\n      divider: {}\n    },\n    {\n      object: \"block\",\n      type: \"heading_2\",\n      heading_2: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: \"ğŸ“„ Article complet\"\n            }\n          }\n        ]\n      }\n    },\n    // Diviser l'article en paragraphes pour Notion\n    ...($json.contenuArticleComplet || \"\").split('\\\\n\\\\n').filter(p => p.trim()).map(paragraphe => ({\n      object: \"block\",\n      type: \"paragraph\",\n      paragraph: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: paragraphe.substring(0, 2000) // Limite par bloc\n            }\n          }\n        ]\n      }\n    })),\n    {\n      object: \"block\",\n      type: \"divider\",\n      divider: {}\n    },\n    {\n      object: \"block\",\n      type: \"heading_2\",\n      heading_2: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: \"ğŸš€ Post LinkedIn prÃªt Ã  publier\"\n            }\n          }\n        ]\n      }\n    },\n    {\n      object: \"block\",\n      type: \"callout\",\n      callout: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: ($json.postLinkedInCompletTotal || \"\").substring(0, 2000)\n            }\n          }\n        ],\n        icon: {\n          type: \"emoji\",\n          emoji: \"ğŸ“±\"\n        },\n        color: \"blue_background\"\n      }\n    },\n    {\n      object: \"block\",\n      type: \"divider\",\n      divider: {}\n    },\n    {\n      object: \"block\",\n      type: \"heading_3\",\n      heading_3: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: \"ğŸ“Š MÃ©tadonnÃ©es\"\n            }\n          }\n        ]\n      }\n    },\n    {\n      object: \"block\",\n      type: \"bulleted_list_item\",\n      bulleted_list_item: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: `GÃ©nÃ©rÃ© le : ${new Date($json.dateGeneration).toLocaleString('fr-FR')}`\n            }\n          }\n        ]\n      }\n    },\n    {\n      object: \"block\",\n      type: \"bulleted_list_item\",\n      bulleted_list_item: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: `Longueur : ${$json.nombreMots || 0} mots (${$json.longueurArticle || 0} caractÃ¨res)`\n            }\n          }\n        ]\n      }\n    },\n    {\n      object: \"block\",\n      type: \"bulleted_list_item\",\n      bulleted_list_item: {\n        rich_text: [\n          {\n            type: \"text\",\n            text: {\n              content: `ID de l'idÃ©e source : ${$json.ideaId}`\n            }\n          }\n        ]\n      }\n    }\n  ]\n};\n\n// Retourner le payload avec toutes les autres donnÃ©es\nreturn {\n  ...($json || {}),\n  notionPayload: notionPayload\n};"
      },
      "id": "prepare-notion-payload",
      "name": "ğŸ”§ PrÃ©parer payload Notion",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1900, 400]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.notion.com/v1/pages",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "notionApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Notion-Version",
              "value": "2022-06-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.notionPayload }}",
        "options": {}
      },
      "id": "notion-create-article",
      "name": "ğŸ’¾ CrÃ©er Article dans Notion",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [2100, 400],
      "credentials": {
        "notionApi": {
          "id": "aH0S5x4M973O80uj",
          "name": "Notion LinkedIn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Extraction des donnÃ©es de l'article crÃ©Ã©\nreturn {\n  articleId: $json.id,\n  articleUrl: $json.url,\n  createdTime: $json.created_time,\n  titre: $json.properties?.Titre?.title?.[0]?.text?.content || \"Sans titre\",\n  ideaId: $('ğŸ“‹ PrÃ©parer donnÃ©es finales').first().json.ideaId\n};"
      },
      "id": "extract-article-data",
      "name": "ğŸ“Š Extraire donnÃ©es article",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2272, 400]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "={{ `https://api.notion.com/v1/pages/${$('ğŸ“¥ RÃ©cupÃ©rer IdÃ©e Non TraitÃ©e').first().json.id}` }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "notionApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Notion-Version",
              "value": "2022-06-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"properties\": {\n    \"TraitÃ©\": {\n      \"checkbox\": true\n    }\n  }\n}",
        "options": {}
      },
      "id": "notion-update-idea",
      "name": "âœ… Marquer IdÃ©e TraitÃ©e",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [2528, 400],
      "credentials": {
        "notionApi": {
          "id": "aH0S5x4M973O80uj",
          "name": "Notion LinkedIn"
        }
      }
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "=âœ… Article LinkedIn gÃ©nÃ©rÃ© avec succÃ¨s!\n\nğŸ“ Titre: {{ $('ğŸ“Š Extraire donnÃ©es article').first().json.titre }}\nğŸ“„ Article ID: {{ $('ğŸ“Š Extraire donnÃ©es article').first().json.articleId }}\nğŸ”— URL Notion: {{ $('ğŸ“Š Extraire donnÃ©es article').first().json.articleUrl }}\nâ° CrÃ©Ã© le: {{ $('ğŸ“Š Extraire donnÃ©es article').first().json.createdTime }}\n\nâœ”ï¸ L'idÃ©e a Ã©tÃ© marquÃ©e comme traitÃ©e."
            }
          ]
        },
        "options": {}
      },
      "id": "success-message",
      "name": "âœ¨ Message de succÃ¨s",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [2784, 400]
    },
    {
      "parameters": {
        "model": "perplexity/sonar-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [640, 576],
      "id": "8455064c-cbd7-4f0d-8da7-284d0cd6b3ed",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "xLdMbYh4lyLsgJJA",
          "name": "OpenRouter account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "ğŸš€ DÃ©clencheur Manuel": {
      "main": [
        [
          {
            "node": "ğŸ“¥ RÃ©cupÃ©rer IdÃ©e Non TraitÃ©e",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¥ RÃ©cupÃ©rer IdÃ©e Non TraitÃ©e": {
      "main": [
        [
          {
            "node": "ğŸ” PrÃ©parer donnÃ©es idÃ©e",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” PrÃ©parer donnÃ©es idÃ©e": {
      "main": [
        [
          {
            "node": "ğŸ” Agent Recherche Perplexity",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Agent Recherche Perplexity": {
      "main": [
        [
          {
            "node": "âœï¸ Agent RÃ©daction Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœï¸ Agent RÃ©daction Claude": {
      "main": [
        [
          {
            "node": "ğŸ·ï¸ Agent Hashtags GPT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude Model": {
      "ai_languageModel": [
        [
          {
            "node": "âœï¸ Agent RÃ©daction Claude",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ·ï¸ Agent Hashtags GPT": {
      "main": [
        [
          {
            "node": "ğŸ“± SynthÃ¨se LinkedIn Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± SynthÃ¨se LinkedIn Claude": {
      "main": [
        [
          {
            "node": "ğŸ“‹ PrÃ©parer donnÃ©es finales",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ PrÃ©parer donnÃ©es finales": {
      "main": [
        [
          {
            "node": "ğŸ”§ PrÃ©parer payload Notion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”§ PrÃ©parer payload Notion": {
      "main": [
        [
          {
            "node": "ğŸ’¾ CrÃ©er Article dans Notion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ’¾ CrÃ©er Article dans Notion": {
      "main": [
        [
          {
            "node": "ğŸ“Š Extraire donnÃ©es article",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š Extraire donnÃ©es article": {
      "main": [
        [
          {
            "node": "âœ… Marquer IdÃ©e TraitÃ©e",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Marquer IdÃ©e TraitÃ©e": {
      "main": [
        [
          {
            "node": "âœ¨ Message de succÃ¨s",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Model": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ·ï¸ Agent Hashtags GPT",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ” Agent Recherche Perplexity",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Claude LinkedIn Model": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ“± SynthÃ¨se LinkedIn Claude",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "corrige-v1",
  "meta": {
    "instanceId": "403566a9aee191faa03a05967266a85d00d44980ffb18ca114571275711151b4"
  },
  "id": "8fRjPcH3dc54VPPX",
  "tags": []
}
